\hypertarget{struct_obj_cryst_1_1_stretch_mode}{}\section{Obj\+Cryst\+::Stretch\+Mode Struct Reference}
\label{struct_obj_cryst_1_1_stretch_mode}\index{ObjCryst::StretchMode@{ObjCryst::StretchMode}}


{\ttfamily \#include $<$Molecule.\+h$>$}



Inheritance diagram for Obj\+Cryst\+::Stretch\+Mode\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{struct_obj_cryst_1_1_stretch_mode__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Obj\+Cryst\+::Stretch\+Mode\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{struct_obj_cryst_1_1_stretch_mode__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_a5b5ab5f9819c047a49719a330722d419}{Calc\+Deriv}} (const bool derivllk=true) const =0
\item 
\mbox{\Hypertarget{struct_obj_cryst_1_1_stretch_mode_a78c180042fce5981fe0e97071d986362}\label{struct_obj_cryst_1_1_stretch_mode_a78c180042fce5981fe0e97071d986362}} 
virtual void \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_a78c180042fce5981fe0e97071d986362}{Print}} (ostream \&os, bool full=true) const =0
\begin{DoxyCompactList}\small\item\em Print one-\/line list of atoms moved. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{struct_obj_cryst_1_1_stretch_mode_a289eef038fd0e5aaddb8097c55692ffe}\label{struct_obj_cryst_1_1_stretch_mode_a289eef038fd0e5aaddb8097c55692ffe}} 
virtual void \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_a289eef038fd0e5aaddb8097c55692ffe}{Stretch}} (const R\+E\+AL change, const bool keep\+Center=true)=0
\begin{DoxyCompactList}\small\item\em Move the atoms according to this mode. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{struct_obj_cryst_1_1_stretch_mode_a18db484818754a913f025ffd1c547b47}\label{struct_obj_cryst_1_1_stretch_mode_a18db484818754a913f025ffd1c547b47}} 
virtual void \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_a18db484818754a913f025ffd1c547b47}{Random\+Stretch}} (const R\+E\+AL amplitude, const bool keep\+Center=true)=0
\begin{DoxyCompactList}\small\item\em Move the atoms according to this mode, randomly. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::map$<$ const \mbox{\hyperlink{class_obj_cryst_1_1_mol_bond}{Mol\+Bond}} $\ast$, R\+E\+AL $>$ \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_a6628812c69f20a7a18a7a3759b5c961c}{mvp\+Broken\+Bond}}
\item 
std\+::map$<$ const \mbox{\hyperlink{class_obj_cryst_1_1_mol_bond_angle}{Mol\+Bond\+Angle}} $\ast$, R\+E\+AL $>$ \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_a2a46f6bd997850be6736e4b5746deeed}{mvp\+Broken\+Bond\+Angle}}
\item 
std\+::map$<$ const \mbox{\hyperlink{class_obj_cryst_1_1_mol_dihedral_angle}{Mol\+Dihedral\+Angle}} $\ast$, R\+E\+AL $>$ \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_a84257bc829a3d612b68046d33685e59e}{mvp\+Broken\+Dihedral\+Angle}}
\item 
\mbox{\Hypertarget{struct_obj_cryst_1_1_stretch_mode_ac6614921c015de3f6d67b22ae512a66c}\label{struct_obj_cryst_1_1_stretch_mode_ac6614921c015de3f6d67b22ae512a66c}} 
R\+E\+AL \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_ac6614921c015de3f6d67b22ae512a66c}{m\+L\+L\+K\+Deriv}}
\begin{DoxyCompactList}\small\item\em Derivative of the \mbox{\hyperlink{class_obj_cryst_1_1_molecule}{Molecule}}\textquotesingle{}s Log(likelihood) versus a change of the bond length. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{struct_obj_cryst_1_1_stretch_mode_a4a25093e177c56be142acc954149c110}\label{struct_obj_cryst_1_1_stretch_mode_a4a25093e177c56be142acc954149c110}} 
std\+::map$<$ const \mbox{\hyperlink{class_obj_cryst_1_1_mol_atom}{Mol\+Atom}} $\ast$, \mbox{\hyperlink{struct_obj_cryst_1_1_x_y_z}{X\+YZ}} $>$ \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_a4a25093e177c56be142acc954149c110}{m\+Deriv\+X\+YZ}}
\begin{DoxyCompactList}\small\item\em Derivative of the atomic positions versus a change of the bond length. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{struct_obj_cryst_1_1_stretch_mode_a380bd0aef1e5be1f681364e0f754f3e3}\label{struct_obj_cryst_1_1_stretch_mode_a380bd0aef1e5be1f681364e0f754f3e3}} 
\mbox{\hyperlink{class_obj_cryst_1_1_molecule}{Molecule}} $\ast$ \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_a380bd0aef1e5be1f681364e0f754f3e3}{mp\+Mol}}
\begin{DoxyCompactList}\small\item\em The \mbox{\hyperlink{class_obj_cryst_1_1_molecule}{Molecule}} corresponding to this stretch mode. \end{DoxyCompactList}\item 
R\+E\+AL \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_aa8dc03e2bd6840d13964dd6751c39fae}{m\+Base\+Amplitude}}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Abstract base Stretch Mode for \mbox{\hyperlink{class_obj_cryst_1_1_molecule}{Molecule}} objects 

\subsection{Member Function Documentation}
\mbox{\Hypertarget{struct_obj_cryst_1_1_stretch_mode_a5b5ab5f9819c047a49719a330722d419}\label{struct_obj_cryst_1_1_stretch_mode_a5b5ab5f9819c047a49719a330722d419}} 
\index{ObjCryst::StretchMode@{ObjCryst::StretchMode}!CalcDeriv@{CalcDeriv}}
\index{CalcDeriv@{CalcDeriv}!ObjCryst::StretchMode@{ObjCryst::StretchMode}}
\subsubsection{\texorpdfstring{CalcDeriv()}{CalcDeriv()}}
{\footnotesize\ttfamily virtual void Obj\+Cryst\+::\+Stretch\+Mode\+::\+Calc\+Deriv (\begin{DoxyParamCaption}\item[{const bool}]{derivllk = {\ttfamily true} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [pure virtual]}}

Calculate the derivative of the \mbox{\hyperlink{class_obj_cryst_1_1_molecule}{Molecule}}\textquotesingle{}s Log(likelihood) and atomic positions versus a change of the bond length. The result is stored in m\+L\+L\+K\+Deriv and m\+L\+L\+K\+Deriv\+X\+YZ, as well as in the various lists of restraints broken by this mode.


\begin{DoxyParams}{Parameters}
{\em derivllk} & if false, the derivative of the overall llk will not be computed, only the derivative of the atomic positions. \\
\hline
\end{DoxyParams}


Implemented in \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_twist_afbc57b887f9c886b3642d0b7368fd4ad}{Obj\+Cryst\+::\+Stretch\+Mode\+Twist}}, \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_torsion_af8e6659a98b089589e7485ff13e9eb66}{Obj\+Cryst\+::\+Stretch\+Mode\+Torsion}}, \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_bond_angle_a72c7ded6a3919b589dabbbd46c43671b}{Obj\+Cryst\+::\+Stretch\+Mode\+Bond\+Angle}}, and \mbox{\hyperlink{struct_obj_cryst_1_1_stretch_mode_bond_length_ab418eb610ae49059454ca1a2fe7fb9a3}{Obj\+Cryst\+::\+Stretch\+Mode\+Bond\+Length}}.



\subsection{Member Data Documentation}
\mbox{\Hypertarget{struct_obj_cryst_1_1_stretch_mode_aa8dc03e2bd6840d13964dd6751c39fae}\label{struct_obj_cryst_1_1_stretch_mode_aa8dc03e2bd6840d13964dd6751c39fae}} 
\index{ObjCryst::StretchMode@{ObjCryst::StretchMode}!mBaseAmplitude@{mBaseAmplitude}}
\index{mBaseAmplitude@{mBaseAmplitude}!ObjCryst::StretchMode@{ObjCryst::StretchMode}}
\subsubsection{\texorpdfstring{mBaseAmplitude}{mBaseAmplitude}}
{\footnotesize\ttfamily R\+E\+AL Obj\+Cryst\+::\+Stretch\+Mode\+::m\+Base\+Amplitude}

The recommended change amplitude, for a base global optimization displacement, to obtain an average 0.\+1 Angstroem displacement.

This is learnt at the beginning of an optimization.

This can be superseeded to respect any restraint. \mbox{\Hypertarget{struct_obj_cryst_1_1_stretch_mode_a6628812c69f20a7a18a7a3759b5c961c}\label{struct_obj_cryst_1_1_stretch_mode_a6628812c69f20a7a18a7a3759b5c961c}} 
\index{ObjCryst::StretchMode@{ObjCryst::StretchMode}!mvpBrokenBond@{mvpBrokenBond}}
\index{mvpBrokenBond@{mvpBrokenBond}!ObjCryst::StretchMode@{ObjCryst::StretchMode}}
\subsubsection{\texorpdfstring{mvpBrokenBond}{mvpBrokenBond}}
{\footnotesize\ttfamily std\+::map$<$const \mbox{\hyperlink{class_obj_cryst_1_1_mol_bond}{Mol\+Bond}}$\ast$,R\+E\+AL$>$ Obj\+Cryst\+::\+Stretch\+Mode\+::mvp\+Broken\+Bond}

List of bond restraints affected by this mode The key is the restraint, the value is the derivative of the L\+LK associated \mbox{\Hypertarget{struct_obj_cryst_1_1_stretch_mode_a2a46f6bd997850be6736e4b5746deeed}\label{struct_obj_cryst_1_1_stretch_mode_a2a46f6bd997850be6736e4b5746deeed}} 
\index{ObjCryst::StretchMode@{ObjCryst::StretchMode}!mvpBrokenBondAngle@{mvpBrokenBondAngle}}
\index{mvpBrokenBondAngle@{mvpBrokenBondAngle}!ObjCryst::StretchMode@{ObjCryst::StretchMode}}
\subsubsection{\texorpdfstring{mvpBrokenBondAngle}{mvpBrokenBondAngle}}
{\footnotesize\ttfamily std\+::map$<$const \mbox{\hyperlink{class_obj_cryst_1_1_mol_bond_angle}{Mol\+Bond\+Angle}}$\ast$,R\+E\+AL$>$ Obj\+Cryst\+::\+Stretch\+Mode\+::mvp\+Broken\+Bond\+Angle}

List of bond angle restraints modified by this mode The key is the restraint, the value is the derivative of the L\+LK associated \mbox{\Hypertarget{struct_obj_cryst_1_1_stretch_mode_a84257bc829a3d612b68046d33685e59e}\label{struct_obj_cryst_1_1_stretch_mode_a84257bc829a3d612b68046d33685e59e}} 
\index{ObjCryst::StretchMode@{ObjCryst::StretchMode}!mvpBrokenDihedralAngle@{mvpBrokenDihedralAngle}}
\index{mvpBrokenDihedralAngle@{mvpBrokenDihedralAngle}!ObjCryst::StretchMode@{ObjCryst::StretchMode}}
\subsubsection{\texorpdfstring{mvpBrokenDihedralAngle}{mvpBrokenDihedralAngle}}
{\footnotesize\ttfamily std\+::map$<$const \mbox{\hyperlink{class_obj_cryst_1_1_mol_dihedral_angle}{Mol\+Dihedral\+Angle}}$\ast$,R\+E\+AL$>$ Obj\+Cryst\+::\+Stretch\+Mode\+::mvp\+Broken\+Dihedral\+Angle}

List of dihedral angle restraints modified by this mode The key is the restraint, the value is the derivative of the L\+LK associated 

The documentation for this struct was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
Molecule.\+h\item 
Molecule.\+cpp\end{DoxyCompactItemize}
