\hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser}{}\section{Obj\+Cryst\+::Powder\+Pattern\+Background\+Bayesian\+Minimiser Class Reference}
\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser}\index{ObjCryst::PowderPatternBackgroundBayesianMinimiser@{ObjCryst::PowderPatternBackgroundBayesianMinimiser}}


{\ttfamily \#include $<$Powder\+Pattern\+Background\+Bayesian\+Minimiser.\+h$>$}



Inheritance diagram for Obj\+Cryst\+::Powder\+Pattern\+Background\+Bayesian\+Minimiser\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=260pt]{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Obj\+Cryst\+::Powder\+Pattern\+Background\+Bayesian\+Minimiser\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a38fecc6393f5feed3dd22e585d2fd708}\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a38fecc6393f5feed3dd22e585d2fd708}} 
{\bfseries Powder\+Pattern\+Background\+Bayesian\+Minimiser} (\mbox{\hyperlink{class_obj_cryst_1_1_powder_pattern_background}{Powder\+Pattern\+Background}} \&backgd)
\item 
\mbox{\Hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_adde881be1569272ac0e24d570f06a6d0}\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_adde881be1569272ac0e24d570f06a6d0}} 
virtual const string \& {\bfseries Get\+Class\+Name} () const
\item 
\mbox{\Hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a6fa6a85c92002c23a4e7a781d78dcc21}\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a6fa6a85c92002c23a4e7a781d78dcc21}} 
virtual R\+E\+AL {\bfseries Get\+Log\+Likelihood} () const
\item 
\mbox{\Hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a7f91be645bb668d83ab4e198c2d343eb}\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a7f91be645bb668d83ab4e198c2d343eb}} 
virtual unsigned int {\bfseries Get\+Nb\+L\+S\+Q\+Function} () const
\item 
\mbox{\Hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a0304bd59d3cb7f3468cf20022d98a34e}\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a0304bd59d3cb7f3468cf20022d98a34e}} 
virtual const Cryst\+Vector\+\_\+\+R\+E\+AL \& {\bfseries Get\+L\+S\+Q\+Calc} (const unsigned int) const
\item 
\mbox{\Hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_ad99f84375cfb492adb985d5d3233db42}\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_ad99f84375cfb492adb985d5d3233db42}} 
virtual const Cryst\+Vector\+\_\+\+R\+E\+AL \& {\bfseries Get\+L\+S\+Q\+Obs} (const unsigned int) const
\item 
\mbox{\Hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a2e61e6dc76c1d84c42331a56073bd813}\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a2e61e6dc76c1d84c42331a56073bd813}} 
virtual const Cryst\+Vector\+\_\+\+R\+E\+AL \& {\bfseries Get\+L\+S\+Q\+Weight} (const unsigned int) const
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static R\+E\+AL \mbox{\hyperlink{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a43c728298ae10f6f4d454a55abd9765d}{Bayesian\+Background\+Log\+Likelihood}} (const R\+E\+AL t)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_ab87e1261cd1824365908c4d67e9d696e}\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_ab87e1261cd1824365908c4d67e9d696e}} 
\mbox{\hyperlink{class_obj_cryst_1_1_powder_pattern_background}{Powder\+Pattern\+Background}} $\ast$ {\bfseries mp\+Background}
\item 
\mbox{\Hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a0dd792c01eec6984e566ae0c130a606c}\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a0dd792c01eec6984e566ae0c130a606c}} 
Cryst\+Vector\+\_\+\+R\+E\+AL \mbox{\hyperlink{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a0dd792c01eec6984e566ae0c130a606c}{m\+Bayesian\+Calc}}
\begin{DoxyCompactList}\small\item\em Bayesian cost (-\/log(likelihood)) for each point. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a0a5ae9cfa443f7a9d7b23029a65c235a}\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a0a5ae9cfa443f7a9d7b23029a65c235a}} 
Cryst\+Vector\+\_\+\+R\+E\+AL \mbox{\hyperlink{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a0a5ae9cfa443f7a9d7b23029a65c235a}{m\+Bayesian\+Obs}}
\begin{DoxyCompactList}\small\item\em Obs==0 (desired -\/log(likelihood)) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a22e183fdaaa7cc3f58297cdcabbb73ab}\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a22e183fdaaa7cc3f58297cdcabbb73ab}} 
Cryst\+Vector\+\_\+\+R\+E\+AL \mbox{\hyperlink{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a22e183fdaaa7cc3f58297cdcabbb73ab}{m\+Bayesian\+Weight}}
\begin{DoxyCompactList}\small\item\em Weight=1. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This object is used to estimate the background in a powder pattern, using a Bayesian approach (David \& Sivia, Acta Cryst A50 (1994), 703) 

\subsection{Member Function Documentation}
\mbox{\Hypertarget{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a43c728298ae10f6f4d454a55abd9765d}\label{class_obj_cryst_1_1_powder_pattern_background_bayesian_minimiser_a43c728298ae10f6f4d454a55abd9765d}} 
\index{ObjCryst::PowderPatternBackgroundBayesianMinimiser@{ObjCryst::PowderPatternBackgroundBayesianMinimiser}!BayesianBackgroundLogLikelihood@{BayesianBackgroundLogLikelihood}}
\index{BayesianBackgroundLogLikelihood@{BayesianBackgroundLogLikelihood}!ObjCryst::PowderPatternBackgroundBayesianMinimiser@{ObjCryst::PowderPatternBackgroundBayesianMinimiser}}
\subsubsection{\texorpdfstring{BayesianBackgroundLogLikelihood()}{BayesianBackgroundLogLikelihood()}}
{\footnotesize\ttfamily R\+E\+AL Obj\+Cryst\+::\+Powder\+Pattern\+Background\+Bayesian\+Minimiser\+::\+Bayesian\+Background\+Log\+Likelihood (\begin{DoxyParamCaption}\item[{const R\+E\+AL}]{t }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Returns the log(likelihood) of a background by marginalizing the effect of Bragg peaks, following the method described by David and Sivia ({\itshape J.\+Appl.\+Cryst}. {\bfseries{34}}(2001), 318).

\begin{DoxyReturn}{Returns}

\begin{DoxyItemize}
\item $ L(t) = \frac{\left(y^{calc}_{Background}-y^{obs}\right)^2}{2\sigma^2}$ for \textbackslash{}t$<$0
\item $ L(t) = A-\log{\int_\epsilon^{\infty} {\frac{1}{u} e^{-(t-u)^2} du}}$ for t$>$0, with\+: $\epsilon = 1e-6$, $ t = \frac{y^{calc}_{Background}-y^{obs}}{\sigma\sqrt{2}}$ and A a normalizing constant so that the function is continuous for t=0 (i.\+e. {\itshape L(0)=0}).
\end{DoxyItemize}
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em } & \\
\hline
\end{DoxyParams}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
Powder\+Pattern\+Background\+Bayesian\+Minimiser.\+h\item 
Powder\+Pattern\+Background\+Bayesian\+Minimiser.\+cpp\end{DoxyCompactItemize}
