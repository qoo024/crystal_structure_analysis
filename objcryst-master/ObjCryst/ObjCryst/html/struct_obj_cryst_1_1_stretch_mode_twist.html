<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ObjCryst: ObjCryst::StretchModeTwist Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ObjCryst
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_obj_cryst.html">ObjCryst</a></li><li class="navelem"><a class="el" href="struct_obj_cryst_1_1_stretch_mode_twist.html">StretchModeTwist</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="struct_obj_cryst_1_1_stretch_mode_twist-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ObjCryst::StretchModeTwist Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_molecule_8h_source.html">Molecule.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ObjCryst::StretchModeTwist:</div>
<div class="dyncontent">
<div class="center"><img src="struct_obj_cryst_1_1_stretch_mode_twist__inherit__graph.png" border="0" usemap="#_obj_cryst_1_1_stretch_mode_twist_inherit__map" alt="Inheritance graph"/></div>
<map name="_obj_cryst_1_1_stretch_mode_twist_inherit__map" id="_obj_cryst_1_1_stretch_mode_twist_inherit__map">
<area shape="rect"  title=" " alt="" coords="5,79,192,104"/>
<area shape="rect"  href="struct_obj_cryst_1_1_stretch_mode.html" title=" " alt="" coords="21,5,177,31"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for ObjCryst::StretchModeTwist:</div>
<div class="dyncontent">
<div class="center"><img src="struct_obj_cryst_1_1_stretch_mode_twist__coll__graph.png" border="0" usemap="#_obj_cryst_1_1_stretch_mode_twist_coll__map" alt="Collaboration graph"/></div>
<map name="_obj_cryst_1_1_stretch_mode_twist_coll__map" id="_obj_cryst_1_1_stretch_mode_twist_coll__map">
<area shape="rect"  title=" " alt="" coords="521,503,707,528"/>
<area shape="rect"  href="struct_obj_cryst_1_1_stretch_mode.html" title=" " alt="" coords="461,428,617,453"/>
<area shape="rect"  href="class_obj_cryst_1_1_molecule.html" title=" " alt="" coords="418,328,551,353"/>
<area shape="rect"  href="class_obj_cryst_1_1_scatterer.html" title="Generic type of scatterer: can be an atom, or a more complex assembly of atoms." alt="" coords="260,241,395,267"/>
<area shape="rect"  title=" " alt="" coords="258,5,356,31"/>
<area shape="rect"  href="class_obj_cryst_1_1_unit_cell.html" title="Unit Cell class: Unit cell with spacegroup information." alt="" coords="329,80,456,105"/>
<area shape="rect"  href="class_obj_cryst_1_1_crystal.html" title="Crystal class: Unit cell, spacegroup, scatterers." alt="" coords="330,155,452,180"/>
<area shape="rect"  href="class_obj_cryst_1_1_scattering_component_list.html" title="list of scattering positions in a crystal, associated with the corresponding occupancy and a pointer ..." alt="" coords="5,241,236,267"/>
<area shape="rect"  href="class_obj_cryst_1_1_mol_atom.html" title=" " alt="" coords="601,241,734,267"/>
<area shape="rect"  href="class_obj_cryst_1_1_quaternion.html" title=" " alt="" coords="418,241,564,267"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6ed224b06c93f630ccb7bf7920f054a9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode_twist.html#a6ed224b06c93f630ccb7bf7920f054a9">StretchModeTwist</a> (<a class="el" href="class_obj_cryst_1_1_mol_atom.html">MolAtom</a> &amp;at1, <a class="el" href="class_obj_cryst_1_1_mol_atom.html">MolAtom</a> &amp;at2)</td></tr>
<tr class="separator:a6ed224b06c93f630ccb7bf7920f054a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbc57b887f9c886b3642d0b7368fd4ad"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode_twist.html#afbc57b887f9c886b3642d0b7368fd4ad">CalcDeriv</a> (const bool derivllk=true) const</td></tr>
<tr class="separator:afbc57b887f9c886b3642d0b7368fd4ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d9ddf5caed88f32e013d1d286e979f2"><td class="memItemLeft" align="right" valign="top"><a id="a4d9ddf5caed88f32e013d1d286e979f2"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode_twist.html#a4d9ddf5caed88f32e013d1d286e979f2">Print</a> (ostream &amp;os, bool full=true) const</td></tr>
<tr class="memdesc:a4d9ddf5caed88f32e013d1d286e979f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print one-line list of atoms moved. <br /></td></tr>
<tr class="separator:a4d9ddf5caed88f32e013d1d286e979f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89b177c567b0b61162b88205a0009583"><td class="memItemLeft" align="right" valign="top"><a id="a89b177c567b0b61162b88205a0009583"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode_twist.html#a89b177c567b0b61162b88205a0009583">Stretch</a> (const REAL change, const bool keepCenter=true)</td></tr>
<tr class="memdesc:a89b177c567b0b61162b88205a0009583"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move the atoms according to this mode. <br /></td></tr>
<tr class="separator:a89b177c567b0b61162b88205a0009583"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb8145423cd1e43d6ced7ef73f1815d4"><td class="memItemLeft" align="right" valign="top"><a id="adb8145423cd1e43d6ced7ef73f1815d4"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode_twist.html#adb8145423cd1e43d6ced7ef73f1815d4">RandomStretch</a> (const REAL amplitude, const bool keepCenter=true)</td></tr>
<tr class="memdesc:adb8145423cd1e43d6ced7ef73f1815d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move the atoms according to this mode, randomly. <br /></td></tr>
<tr class="separator:adb8145423cd1e43d6ced7ef73f1815d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ad744e9f68b07367752ed7c03d381a30c"><td class="memItemLeft" align="right" valign="top"><a id="ad744e9f68b07367752ed7c03d381a30c"></a>
<a class="el" href="class_obj_cryst_1_1_mol_atom.html">MolAtom</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode_twist.html#ad744e9f68b07367752ed7c03d381a30c">mpAtom1</a></td></tr>
<tr class="memdesc:ad744e9f68b07367752ed7c03d381a30c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The first atom. <br /></td></tr>
<tr class="separator:ad744e9f68b07367752ed7c03d381a30c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36180a825c130a18a59c6cfe1a44398c"><td class="memItemLeft" align="right" valign="top"><a id="a36180a825c130a18a59c6cfe1a44398c"></a>
<a class="el" href="class_obj_cryst_1_1_mol_atom.html">MolAtom</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode_twist.html#a36180a825c130a18a59c6cfe1a44398c">mpAtom2</a></td></tr>
<tr class="memdesc:a36180a825c130a18a59c6cfe1a44398c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The second atom. <br /></td></tr>
<tr class="separator:a36180a825c130a18a59c6cfe1a44398c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b3c7f8a0bf81c04ca39fcc88e596f22"><td class="memItemLeft" align="right" valign="top"><a id="a5b3c7f8a0bf81c04ca39fcc88e596f22"></a>
set&lt; <a class="el" href="class_obj_cryst_1_1_mol_atom.html">MolAtom</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode_twist.html#a5b3c7f8a0bf81c04ca39fcc88e596f22">mvRotatedAtomList</a></td></tr>
<tr class="memdesc:a5b3c7f8a0bf81c04ca39fcc88e596f22"><td class="mdescLeft">&#160;</td><td class="mdescRight">The set of atoms that are to be rotated around at1-at2. <br /></td></tr>
<tr class="separator:a5b3c7f8a0bf81c04ca39fcc88e596f22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_struct_obj_cryst_1_1_stretch_mode')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="struct_obj_cryst_1_1_stretch_mode.html">ObjCryst::StretchMode</a></td></tr>
<tr class="memitem:a6628812c69f20a7a18a7a3759b5c961c inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memItemLeft" align="right" valign="top">std::map&lt; const <a class="el" href="class_obj_cryst_1_1_mol_bond.html">MolBond</a> *, REAL &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode.html#a6628812c69f20a7a18a7a3759b5c961c">mvpBrokenBond</a></td></tr>
<tr class="separator:a6628812c69f20a7a18a7a3759b5c961c inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a46f6bd997850be6736e4b5746deeed inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memItemLeft" align="right" valign="top">std::map&lt; const <a class="el" href="class_obj_cryst_1_1_mol_bond_angle.html">MolBondAngle</a> *, REAL &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode.html#a2a46f6bd997850be6736e4b5746deeed">mvpBrokenBondAngle</a></td></tr>
<tr class="separator:a2a46f6bd997850be6736e4b5746deeed inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84257bc829a3d612b68046d33685e59e inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memItemLeft" align="right" valign="top">std::map&lt; const <a class="el" href="class_obj_cryst_1_1_mol_dihedral_angle.html">MolDihedralAngle</a> *, REAL &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode.html#a84257bc829a3d612b68046d33685e59e">mvpBrokenDihedralAngle</a></td></tr>
<tr class="separator:a84257bc829a3d612b68046d33685e59e inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6614921c015de3f6d67b22ae512a66c inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memItemLeft" align="right" valign="top"><a id="ac6614921c015de3f6d67b22ae512a66c"></a>
REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode.html#ac6614921c015de3f6d67b22ae512a66c">mLLKDeriv</a></td></tr>
<tr class="memdesc:ac6614921c015de3f6d67b22ae512a66c inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derivative of the <a class="el" href="class_obj_cryst_1_1_molecule.html">Molecule</a>'s Log(likelihood) versus a change of the bond length. <br /></td></tr>
<tr class="separator:ac6614921c015de3f6d67b22ae512a66c inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a25093e177c56be142acc954149c110 inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memItemLeft" align="right" valign="top"><a id="a4a25093e177c56be142acc954149c110"></a>
std::map&lt; const <a class="el" href="class_obj_cryst_1_1_mol_atom.html">MolAtom</a> *, <a class="el" href="struct_obj_cryst_1_1_x_y_z.html">XYZ</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode.html#a4a25093e177c56be142acc954149c110">mDerivXYZ</a></td></tr>
<tr class="memdesc:a4a25093e177c56be142acc954149c110 inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derivative of the atomic positions versus a change of the bond length. <br /></td></tr>
<tr class="separator:a4a25093e177c56be142acc954149c110 inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a380bd0aef1e5be1f681364e0f754f3e3 inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memItemLeft" align="right" valign="top"><a id="a380bd0aef1e5be1f681364e0f754f3e3"></a>
<a class="el" href="class_obj_cryst_1_1_molecule.html">Molecule</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode.html#a380bd0aef1e5be1f681364e0f754f3e3">mpMol</a></td></tr>
<tr class="memdesc:a380bd0aef1e5be1f681364e0f754f3e3 inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="class_obj_cryst_1_1_molecule.html">Molecule</a> corresponding to this stretch mode. <br /></td></tr>
<tr class="separator:a380bd0aef1e5be1f681364e0f754f3e3 inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8dc03e2bd6840d13964dd6751c39fae inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memItemLeft" align="right" valign="top">REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_obj_cryst_1_1_stretch_mode.html#aa8dc03e2bd6840d13964dd6751c39fae">mBaseAmplitude</a></td></tr>
<tr class="separator:aa8dc03e2bd6840d13964dd6751c39fae inherit pub_attribs_struct_obj_cryst_1_1_stretch_mode"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Atoms moved <em>between</em> two other atoms, using a "twist" of their positions - only small twists of their positions are allowed to avoid breaking restraints too much. Also, the atoms in the middle between the two reference atoms are more displaced than the one closer, to help avoid breaking restraints. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a6ed224b06c93f630ccb7bf7920f054a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ed224b06c93f630ccb7bf7920f054a9">&#9670;&nbsp;</a></span>StretchModeTwist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ObjCryst::StretchModeTwist::StretchModeTwist </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_obj_cryst_1_1_mol_atom.html">MolAtom</a> &amp;&#160;</td>
          <td class="paramname"><em>at1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_obj_cryst_1_1_mol_atom.html">MolAtom</a> &amp;&#160;</td>
          <td class="paramname"><em>at2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor If pDihedralAngle!=0, the dihedral angle length restraint is respected. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="afbc57b887f9c886b3642d0b7368fd4ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbc57b887f9c886b3642d0b7368fd4ad">&#9670;&nbsp;</a></span>CalcDeriv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ObjCryst::StretchModeTwist::CalcDeriv </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>derivllk</em> = <code>true</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the derivative of the <a class="el" href="class_obj_cryst_1_1_molecule.html">Molecule</a>'s Log(likelihood) and atomic positions versus a change of the bond length. The result is stored in mLLKDeriv and mLLKDerivXYZ, as well as in the various lists of restraints broken by this mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">derivllk</td><td>if false, the derivative of the overall llk will not be computed, only the derivative of the atomic positions. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="struct_obj_cryst_1_1_stretch_mode.html#a5b5ab5f9819c047a49719a330722d419">ObjCryst::StretchMode</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following files:<ul>
<li><a class="el" href="_molecule_8h_source.html">Molecule.h</a></li>
<li>Molecule.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
